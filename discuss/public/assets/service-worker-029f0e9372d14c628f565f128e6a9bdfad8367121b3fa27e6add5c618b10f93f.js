"use strict";importScripts("/javascripts/workbox/workbox-sw.js"),workbox.setConfig({modulePathPrefix:"/javascripts/workbox",debug:!1});var authUrl="/auth/",cacheVersion="1",discourseCacheName="discourse-"+cacheVersion,externalCacheName="external-"+cacheVersion;workbox.routing.registerRoute(function(e){return e.url.origin===location.origin&&!e.url.pathname.startsWith(authUrl)},new workbox.strategies.NetworkFirst({cacheName:discourseCacheName,plugins:[new workbox.cacheableResponse.Plugin({statuses:[200]}),new workbox.expiration.Plugin({maxAgeSeconds:604800,maxEntries:250,purgeOnQuotaError:!0})]}));var cdnUrls=[];workbox.routing.registerRoute(function(t){return t.url.origin!==location.origin&&0===cdnUrls.filter(function(e){return t.url.href.startsWith(e)}).length},new workbox.strategies.NetworkFirst({cacheName:externalCacheName,plugins:[new workbox.cacheableResponse.Plugin({statuses:[200]}),new workbox.expiration.Plugin({maxAgeSeconds:604800,maxEntries:250,purgeOnQuotaError:!0})]}));var idleThresholdTime=1e4,lastAction=-1;function isIdle(){return lastAction+idleThresholdTime<Date.now()}function showNotification(e,t,i,n,o,r,a){o={body:t,icon:i,badge:n,data:{url:a,baseUrl:r},tag:o};return self.registration.showNotification(e,o)}self.addEventListener("push",function(e){var t=e.data.json();if(!isIdle()&&t.hide_when_active)return!1;e.waitUntil(self.registration.getNotifications({tag:t.tag}).then(function(e){return e&&0<e.length&&e.forEach(function(e){e.close()}),showNotification(t.title,t.body,t.icon,t.badge,t.tag,t.base_url,t.url)}))}),self.addEventListener("notificationclick",function(e){e.notification.close();var t=e.notification.data.url,i=e.notification.data.baseUrl;e.waitUntil(clients.matchAll({type:"window"}).then(function(e){if(!e.some(function(e){return e.url===i+t&&"focus"in e?(e.focus(),!0):"postMessage"in e&&"focus"in e&&(e.focus(),e.postMessage({url:t}),!0)})&&clients.openWindow)return clients.openWindow(i+t)}))}),self.addEventListener("message",function(e){"lastAction"in e.data&&(lastAction=e.data.lastAction)});
//# sourceMappingURL=/assets/service-worker-029f0e9372d14c628f565f128e6a9bdfad8367121b3fa27e6add5c618b10f93f.js.map